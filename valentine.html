<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ’ Countdown</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="card">
    <h1>Yay!! ğŸ’—</h1>
    <p>You get your shit on V-Day.</p>

    <!-- âœ… Picture -->
    <div class="photo">
      <img src="assets/countdown.jpg" alt="Valentine vibe ğŸ’" />
    </div>

    <div id="countdownWrap">
      <div class="countdown" id="countdown"></div>
      <p style="margin-top:10px;">Come back later my dick ğŸ’˜</p>
    </div>

    <div id="unlockWrap" class="hidden">
      <p>Itâ€™s Valentineâ€™s Day!! ğŸ‰</p>
      <a class="button primary" id="giftLink" href="game.html">Open it if you dare ğŸ’</a>
    </div>

    <div class="btn-row" style="margin-top:18px;">
      <a class="button secondary small" id="backLink" href="index.html">Back</a>
    </div>
  </div>

  <script src="script.js"></script>
  <script>
    const bgm = makeAudio("assets/bgm.mp3", { loop: true });
    const clickSfx = makeAudio("assets/click.mp3");

    const countdownEl = document.getElementById("countdown");
    const countdownWrap = document.getElementById("countdownWrap");
    const unlockWrap = document.getElementById("unlockWrap");
    const giftLink = document.getElementById("giftLink");
    const backLink = document.getElementById("backLink");

    // Preserve test mode through navigation
    if (isTestMode()) {
      giftLink.href = withTestParam("game.html");
      backLink.href = withTestParam("index.html");
    }

    function tick() {
      const unlocked = isValentinesDayToday() || isTestMode();

      if (unlocked) {
        countdownWrap.classList.add("hidden");
        unlockWrap.classList.remove("hidden");
        return;
      }

      const target = getValentinesTarget();
      countdownEl.textContent = formatCountdown(target - new Date());
    }

    tick();
    setInterval(tick, 1000);

    giftLink.addEventListener("click", () => playSfx(clickSfx));
    backLink.addEventListener("click", () => playSfx(clickSfx));

    // Start music on first tap/click (required on many phones)
    window.addEventListener("pointerdown", () => startBgm(bgm), { once: true });
  </script>
</body>
</html>
